<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8"></meta>
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0"></meta>
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge"></meta>
<title>Structure of Device Driver System Object</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "Simulink Support Package for Raspberry Pi Hardware"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../device-driver-blocks.html",
          "name": "Device Driver Blocks"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "device-driver-blocks"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link>


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript"></meta>
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug"></meta>
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex"></meta>

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Understand the concepts and operation of device driver blocks implemented using System object."></meta><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../includes/product/scripts/jquery/jquery-latest.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6.css?201901150939" rel="stylesheet" type="text/css"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_lg.css?201901150939" rel="stylesheet" media="screen and (min-width: 1200px)"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_md.css?201901150939" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_sm+xs.css?201901150939" rel="stylesheet" media="screen and (max-width: 991px)"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_sm.css?201901150939" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_xs.css?201901150939" rel="stylesheet" media="screen and (max-width: 767px)"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_offcanvas.css?201901150939" rel="stylesheet" type="text/css"></link>

<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/examples.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/helpservices.js"></script>





<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"></link>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print"></link>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container includes_subnav affix-top"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../../documentation-center.html">Documentation</a></h1></div><button type="button" class="navbar-toggle collapsed subnav visible-xs" data-toggle="collapse" data-target=".mobile_subnav_content"><span class="icon-arrow-down icon_24"></span></button></div><div class="crux_nav_container hidden-xs"><div class="crux_nav"><ul id="topnav_main"><li id="crux_nav_documentation" class="crux_nav_active"><a>All</a></li><li id="crux_nav_example"><a href="../examples.html?category=device-driver-blocks">Examples</a></li><li id="crux_nav_function"><a href="../referencelist.html?type=function&amp;category=device-driver-blocks">Functions</a></li><li id="crux_nav_block"><a href="../referencelist.html?type=block&amp;category=device-driver-blocks">Blocks</a></li><li role="presentation" class="dropdown" id="topnav_more" style="display:none;"><a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> More <span class="caret"></span></a><ul class="dropdown-menu"></ul></li></ul></div></div></div><div class="col-xs-12" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2018b" data-language="en" action="../../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> </input><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><div class="row visible-xs" id="mobile_subnav"><div class="col-xs-12"><div class="navbar-collapse collapse mobile_subnav_content"><div class="crux_nav_container"><div class="crux_nav"><ul class="nav navbar-nav subnav"><li id="crux_nav_documentation" class="crux_nav_active"><a>All</a></li><li id="crux_nav_example"><a href="../examples.html?category=device-driver-blocks">Examples</a></li><li id="crux_nav_function"><a href="../referencelist.html?type=function&amp;category=device-driver-blocks">Functions</a></li><li id="crux_nav_block"><a href="../referencelist.html?type=block&amp;category=device-driver-blocks">Blocks</a></li></ul></div></div></div></div></div></div></div><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-filter" tabindex="0"></span><span class="offcanvas_actuator_close" tabindex="0"></span></div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar" role="navigation">
<nav class="offcanvas_nav" role="navigation">
<ul class="nav_breadcrumb"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../../documentation-center.html" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html">Simulink Support Package for Raspberry Pi Hardware</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../device-driver-blocks.html" itemprop="url"><span itemprop="title">Device Driver Blocks</span></a></li></ul><ul class="nav_scrollspy nav">
<li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Structure of Device Driver System Object</a></li>
<li class="nav_scrollspy_title" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#bvg3kff-5" class="intrnllnk">Class Definition</a></li><li><a href="#bvg3kff-6" class="intrnllnk">Constructor Method</a></li><li><a href="#bvg3kff-7" class="intrnllnk">Initialization, Output and Termination Methods</a></li><li><a href="#bvg3kff-8" class="intrnllnk">Input and Output Signal Properties</a></li><li><a href="#bvg3kff-9" class="intrnllnk">Build Artifacts</a></li><li><a href="#d120e3523" class="intrnllnk">See Also</a></li></ul>
</nav>
<script src="../includes/product/scripts/offcanvas.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">

<section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en"><div id="pgtype-topic">
<section itemprop="content"><h2 class="title r2018b" itemprop="title content" id="bvg3kff-4">Structure of Device Driver System Object</h2><p>A device driver block is a specialized <span class="block">MATLAB System</span> block
that generates custom C/C++ code when deployed to a Raspberry
        Pi&#x2122; hardware
board. Device driver blocks provide easy access to features of hardware
boards, such as communication protocols or hardware libraries, not
included in the default <a href="../index.html" class="a">Simulink Support Package for Raspberry Pi Hardware</a>.</p><p>A Simulink<sup>&#x00AE;</sup> device driver block can be generalized to one
of two groups based on their port types:</p><div class="itemizedlist"><ul><li><p><span class="emphasis"><em>Source blocks</em></span> have output ports only. During simulation,
                    a source block outputs a predetermined signal. This signal can be created from a
                    random number generator, a stored array, or a constant value. When deployed to
                    hardware, a source block outputs data captured from the I/O device that the
                    block represents. For example, when deployed to hardware, the digital read block
                    outputs the logical state of the digital I/O pin.</p><div class="informalfigure"><div id="d120e3235" class="mediaobject"><p class="listimage"><img src="source_block.png" alt="" height="116" width="308"></img></p></div></div></li><li><p><span class="emphasis"><em>Sink blocks</em></span> have input ports only. During simulation, a
                    sink block acts as a <span class="block">Terminator</span> block. When deployed to hardware,
                    the sink block sets and updates the I/O device according to the input port
                    signals. For example, when deployed to hardware, the digital write block sets
                    and updates the logical state of the digital I/O pin equal to the input port
                    signal.</p><div class="informalfigure"><div id="d120e3247" class="mediaobject"><p class="listimage"><img src="sink_block.png" alt="" height="115" width="302"></img></p></div></div></li></ul></div><p>To define the behavior of the device driver block, you use a System
        object&#x2122;. Then you use a <a href="../../../simulink/slref/matlabsystem.html"><span class="block">MATLAB System</span></a> block to reference the
            object and include it in a model. Each System
        object uses the <code class="method">setupImpl</code>, <code class="method">stepImpl</code>, and
                <code class="method">releaseImpl</code> methods to define the code initialization, pin output
            behavior, and code termination for the device driver block. Through conditional
            statements in the <code class="method">stepImpl</code>, the device driver block operates in
            simulation mode. This mode enables the entire model to run on the host computer either
            when testing or when you do not have access to a Raspberry
        Pi. System objects also provide services for adding build artifacts. Such
            artifacts include source files, include paths, shared libraries, and preprocessor
            defines, to the Simulink generated code. These artifacts automatically define the port properties
            of a block and generate a block mask.</p><section itemprop="content"><h3 class="title" id="bvg3kff-5">Class Definition</h3><p>At the top of the System Object code, you define the name of
your System Object and the classes it inherits from.</p><div class="code_responsive"><pre class="programlisting"><span class="blue">classdef</span> <em class="replaceable">classname</em> &lt; matlab.System &amp; coder.ExternalDependency &amp; matlab.system.mixin.Propagates

	...

<span class="blue">end</span></pre></div><p>All System Objects must inherit from <code class="class">matlab.System</code>.
In addition, device driver System Objects inherit from <code class="class">coder.ExternalDependency</code> that
provides API’s to add build artifacts to generated code. The <code class="class">matlab.system.mixin.Propagates</code> class
provides API’s to define the output size, data type, and complexity
of a System Object. You can inherit from other classes, e.g. <code class="class">matlab.system.mixin.CustomIcon</code>,
which lets you specify the name and icon used by a MATLAB System Object
block.</p></section><section itemprop="content"><h3 class="title" id="bvg3kff-6">Constructor Method</h3><p>The template System
        object class, used in the <a href="create-a-digital-write-block.html" class="a">Create a Digital Write Block</a> and <a href="create-a-digital-read-block.html" class="a">Create a Digital Read Block</a> guides,
uses a standard constructor method:</p><div class="code_responsive"><pre class="programlisting"><span class="blue">methods</span>
   <span class="green">% Constructor</span>
   <span class="blue">function</span> obj = <em class="replaceable">classname</em>(varargin)
      coder.allowpcode(<span class="violet">'plain'</span>);
      setProperties(obj,nargin,varargin);
   <span class="blue">end</span>

   ...

<span class="blue">end</span>
</pre></div></section><section itemprop="content"><h3 class="title" id="bvg3kff-7">Initialization, Output and Termination Methods</h3><p>These methods define what happens at initialization, output,
and termination. Use <code class="method">setupImpl</code> to initialize the
hardware peripheral. Use <code class="method">stepImpl</code> to read from or
write to the hardware peripheral. Use <code class="method">releaseImpl</code> to
release hardware resources used. These three methods are the backbone
of defining the behavior of a device driver block.</p><div class="code_responsive"><pre class="programlisting"><span class="blue">methods</span> (Access=protected)
   <span class="blue">function</span> setupImpl(obj)
      <span class="green">% Implement tasks that need to be performed only once</span>
   <span class="blue">end</span>

   <span class="blue">function</span> stepImpl(obj,u)
      <span class="green">% Device driver output</span>
   <span class="blue">end</span>

   <span class="blue">function</span> releaseImpl(obj)
      <span class="green">% Termination code</span>
   <span class="blue">end</span>
<span class="blue">end</span>
</pre></div></section><section itemprop="content"><h3 class="title" id="bvg3kff-8">Input and Output Signal Properties</h3><p>This code section defines the number of inputs or outputs of
a block and the data types and sizes. For example, the <code class="method">getNumInputsImpl</code> method
in a sink block, sets the number of input ports. Similarly, the <code class="method">getNumOutputsImpl</code> method
in a source block sets the number of outputs ports.</p><div class="code_responsive"><pre class="programlisting"><span class="blue">methods</span> (Access=protected)
   <span class="green">% Simulink functions</span>
   <span class="blue">function</span> isInputSizeMutableImpl(~,~)
      flag = false;
   <span class="blue">end</span>

   ...

   <span class="blue">function</span> num = getNumInputsImpl(~)
      num = 1;
   <span class="blue">end</span>

   <span class="blue">function</span> num = getNumOutputsImpl(~)
      num = 0;
   <span class="blue">end</span>
<span class="blue">end</span>
</pre></div></section><section itemprop="content"><h3 class="title" id="bvg3kff-9">Build Artifacts</h3><p>The build artifacts define the source file locations, include
paths, shared libraries, library search paths, and preprocessor definitions
required to compile the device driver code. Use the <code class="method">getDescriptiveName</code> method
to define an identification string to the System
        object. The code
generation engine uses this character vector to report errors. Use
the <code class="method">isSupportedContext</code> method to specify the code
generation context. In device driver blocks, only the real-time workshop
(rtw) code generation context applies, so this function always specifies <code class="literal">'rtw'</code>.
Use the <code class="method">updateBuildInfo</code> method to specify source
and header files, include paths, libraries, and defines required to
build the System
        object.</p><div class="code_responsive"><pre class="programlisting"><span class="blue">methods</span> (Static)
   
   <span class="blue">function</span> name = getDescriptiveName()
      name = <span class="violet">'<em class="replaceable"><code>decriptive name</code></em>'</span>;
   <span class="blue">end</span>

   <span class="blue">function</span> tf = isSupportedContext(context)
      tf = context.isCodeGenTarget(<span class="violet">'rtw'</span>);
   <span class="blue">end</span>

   <span class="blue">function</span> updateBuildInfo(buildInfo, context)
        <span class="blue">if</span> context.isCodeGenTarget(<span class="violet">'rtw'</span>)
            <span class="green">% Update buildinfo</span>
            srcDir = fullfile(fileparts(mfilename(<span class="violet">'fullpath'</span>)),<span class="violet">'src'</span>); <span class="green">%#ok&lt;NASU&gt;</span>
            includeDir = fullfile(fileparts(mfilename(<span class="violet">'fullpath'</span>)),<span class="violet">'include'</span>);
            addIncludePaths(buildInfo,includeDir);
            <span class="green">% Use the following API's to add include files, sources and
            % linker flags
            %addIncludeFiles(buildInfo,'source.h',includeDir);
            %addSourceFiles(buildInfo,'source.c',srcDir);
            %addLinkFlags(buildInfo,{'-lSource'});
            %addLinkObjects(buildInfo,'sourcelib.a',srcDir);
            %addCompileFlags(buildInfo,{'-D_DEBUG=1'});
            %addDefines(buildInfo,'MY_DEFINE_1')</span>
   <span class="blue">end</span>
<span class="blue">end</span>
</pre></div></section>
<h2 id="d120e3523">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="create-a-digital-read-block.html"><span itemprop="name">Create a Digital Read Block</span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="create-a-digital-write-block.html"><span itemprop="name">Create a Digital Write Block</span></a></span></p>
</section>
    </div><div class="clearfix"></div>
<div class="feedbackblock">Was this topic helpful?
<input type="button" value="Yes" onClick="openFeedbackWindow('https://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-YES-R2018b');"></input>
<input type="button" value="No" onClick="openFeedbackWindow('https://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-NO-R2018b');"></input>
</div>
</section>

<!--Last updated: Tue Jan 15 09:39:54 EST 2019-->
</div>
</div>
</div><!--close_0960-->
</div><!--close_0970-->
<div xmlns="http://www.w3.org/1999/xhtml" class="body_trail_container">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">
<div class="row"><div class="col-xs-12 col-sm-3"><h5><a href="../index.html?s_cid=doc_ftr">Simulink Support Package for Raspberry Pi Hardware Documentation</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="../examples.html?s_cid=doc_ftr">Examples</a></li>
<li><a href="../referencelist.html?type=function&amp;s_cid=doc_ftr">Functions and Other Reference</a></li>
<li><a href="../release-notes.html?s_cid=doc_ftr">Release Notes</a></li>
</ul>
</div>
<div class="col-xs-12 col-sm-3"><h5><a href="https://www.mathworks.com/support.html?s_cid=doc_ftr">Support</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="https://www.mathworks.com/matlabcentral/answers/index?s_cid=doc_ftr">MATLAB Answers</a></li><li><a href="https://www.mathworks.com/support/install-matlab.html?s_cid=doc_ftr">Installation Help</a></li><li><a href="https://www.mathworks.com/support/bugreports/?s_cid=doc_ftr">Bug Reports</a></li><li><a href="https://www.mathworks.com/products/availability.html?s_cid=doc_ftr">Product Requirements</a></li><li><a href="https://www.mathworks.com/downloads/?s_cid=doc_ftr">Software Downloads</a></li></ul>
</div>
</div>
</div>
</div>
</div><!--END.CLASS container-fluid-->
</div><!--END.CLASS body_trail_container-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-xs-12">
<p class="copyright">© 1994-2019 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="MATLAB:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="MATLAB:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="MATLAB:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="MATLAB:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</body>
</html>
