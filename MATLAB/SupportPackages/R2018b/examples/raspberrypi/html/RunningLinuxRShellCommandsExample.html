
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Running Linux&reg; Shell Commands</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-07-24"><meta name="DC.source" content="RunningLinuxRShellCommandsExample.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><style>
.open_example { 
    padding:0px 0px 1px 0px;
    margin:20px;
    font-size:0.9em;
    border:1px solid #aeaeae;
    display:block;
    float:right;
    border-radius:5px; -moz-border-radius:5px; -webkit-border-radius:5px;
    background: #ffffff; /* Old browsers */
    background: -moz-linear-gradient(top, #FFFFFF 0%, #E6E6E6 100%); /* FF3.6+ */	
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(100%,#E6E6E6)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #FFFFFF 0%,#E6E6E6 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* IE10+ */
    background: linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#FFFFFF', endColorstr='#E6E6E6',GradientType=0 ); /* IE6-9 */
}

.open_example:hover {
    background: #f3f3f3; /* Old browsers */
    background: -moz-linear-gradient(top, #f3f3f3 0%, #d7d7d7 100%); /* FF3.6+ */    
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f3f3f3), color-stop(100%,#d7d7d7)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #f3f3f3 0%,#d7d7d7 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* IE10+ */
    background: linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f3f3f3', endColorstr='#d7d7d7',GradientType=0 ); /* IE6-9 */
} 

.open_example a { 
    padding:6px 10px; 
    line-height:130%;
    text-decoration:none;
    float:left;
}
      </style><div class="open_example"><a href="matlab:openExample('raspberrypi/RunningLinuxRShellCommandsExample')">Open this Example</a></div><div class="content"><h1>Running Linux&reg; Shell Commands</h1><!--introduction--><p>This example shows you how to run Linux shell commands on your Raspberry Pi&reg; hardware.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#2">Prerequisites</a></li><li><a href="#3">Create a Communication Object</a></li><li><a href="#4">Execute system commands on your Raspberry Pi</a></li><li><a href="#5">Run/Stop a Simulink Model</a></li><li><a href="#6">Manipulate files</a></li><li><a href="#7">Summary</a></li></ul></div><h2 id="1">Introduction</h2><p>Raspberry Pi hardware runs a Linux&reg; distribution as the operating system. Using utilities shipped in the Simulink Support Package for Raspberry Pi Hardware, you can remotely execute Linux shell commands on the Raspberry Pi hardware directly from the MATLAB&reg; command line. For example, you can run and stop a Simulink&reg; model, list the contents of a directory, look up the CPU load of a process running on the Raspberry Pi hardware, etc. You can also launch an interactive SSH session directly from within MATLAB.</p><h2 id="2">Prerequisites</h2><div><ul><li>We recommend completing <a href="docid:raspberrypi_ref.example-raspberrypi_gettingstarted">Getting Started with Raspberry Pi&reg; Hardware</a> example.</li></ul></div><h2 id="3">Create a Communication Object</h2><p>Simulink Support Package for Raspberry Pi Hardware uses an SSH connection over TCP/IP to remotely execute Linux shell commands while building and running Simulink models on the Raspberry Pi hardware. You can use the infrastructure developed for this purpose to communicate with the Raspberry Pi hardware.</p><p>Create a raspberrypi object by executing the following on the MATLAB command line:</p><pre>r = raspberrypi</pre><p>The <b>raspberrypi</b> function returns a connection object, h, for Raspberry Pi hardware that has been set up using the targetupdater function. The hostname, user name, and password used to construct the raspberrypi object are the default MATLAB session values for these parameters. Simulink Support Package for Raspberry Pi Hardware saves one set of communication parameters, i.e. hostname, user name and password, for the Raspberry Pi hardware as default MATLAB session values. Note, the default MATLAB session values for the communication parameters are first determined during the firmware update process. The communication parameters may subsequently be changed using the <b>Tools &gt; Run on Target Hardware &gt; Options...</b> UI in a Simulink model and are sticky, meaning that once you change the communication parameter values they are saved as default MATLAB session values, and are used for all Simulink models.</p><p>You may explicitly specify the hostname or IP address, user name, password when you create the raspberrypi object:</p><pre>r = raspberrypi('&lt;hostname or IP address&gt;','&lt;user name&gt;','&lt;password&gt;');</pre><p>The command above shows how to specify hostname, user name, and password. You may want to use this form if you have multiple Raspberry Pi hardware in your network that you want to connect at the same time.</p><p><b>NOTE:</b> In case of a connection failure, a diagnostics error message is reported on the MATLAB command line. If the connection has failed, the most likely cause is incorrect IP address or hostname.</p><h2 id="4">Execute system commands on your Raspberry Pi</h2><p>You can use the system method of the raspberrypi object to execute various Linux shell commands on the Raspberry Pi hardware from MATLAB. Try taking a directory listing.</p><pre>system(r,'ls -al ~')</pre><p>This statement executes a directory list shell command and returns the resulting text output at the MATLAB command prompt. You can store the result in a MATLAB variable to perform further processing. Establish who is the owner of the .profile file under /home/pi.</p><pre>output = system(r,'ls -al /home/pi');
ret = regexp(output, '\s+[\w-]+\s+\d\s+(\w+)\s+.+\.profile\s+', 'tokens');
ret{1}</pre><p>You can also achieve the same result using a single shell command.</p><pre>system(r,'stat --format="%U" /home/pi/.profile')</pre><p>Blink the user LED using system commands.</p><pre>system(r,'echo "none" | sudo tee /sys/class/leds/led0/trigger');
system(r,'echo 0 | sudo tee /sys/class/leds/led0/brightness');
system(r,'echo 1 | sudo tee /sys/class/leds/led0/brightness');</pre><p>The user LED is, by default, wired to trigger off of SD card activity. The LED is re-wired to not have a trigger, enabling setting the LED state manually. You can return the LED back to its original state.</p><pre>system(r,'echo "mmc0" | sudo tee /sys/class/leds/led0/trigger');</pre><p>You cannot execute interactive system commands using the system() method. To execute interactive commands on the Raspberry Pi hardware, you must open a terminal session.</p><pre>openShell(r)</pre><p>This command opens a PuTTY terminal that can execute interactive shell commands like 'top'.</p><h2 id="5">Run/Stop a Simulink Model</h2><p>Simulink Support Package for Raspberry Pi Hardware generates a Linux executable for each Simulink model you run on the Raspberry Pi hardware. The generated executable has the same name as the Simulink model and is saved on the Raspberry Pi hardware. To run/stop a Simulink model, you can use the runModel and stopModel methods of the raspberrypi object.</p><p>1. To run a Simulink model you previously run on the Raspberry Pi hardware, execute the following command on the MATLAB command line:</p><pre>runModel(r,'&lt;model name&gt;')</pre><p>where the string '&lt;model name&gt;' is the name of the Simulink model you want to run on the Raspberry Pi hardware. The runModel method launches the executable corresponding to the Simulink model you specified.</p><p>2. To stop a Simulink model running on the Raspberry Pi hardware, execute the following command on the MATLAB command line:</p><pre>stopModel(r,'&lt;model name&gt;')</pre><p>This command kills the Linux process with the name '&lt;model name&gt;.elf' on the Raspberry Pi hardware. Alternatively, you may execute the following command to stop the model:</p><pre>system(r,'sudo killall &lt;model name&gt;.elf')</pre><h2 id="6">Manipulate files</h2><p>The raspberrypi object provides basic file manipulation capabilities. To transfer a file on Raspberry Pi hardware to your host computer you use the getFile() method.</p><pre>getFile(r,'/usr/share/pixmaps/debian-logo.png');</pre><p>You can then read the PNG file in MATLAB:</p><pre>img = imread('debian-logo.png');
image(img);</pre><p>The getFile() method takes an optional second argument that allows you to define the file destination. To transfer a file on your host computer to Raspberry Pi hardware, you use putFile() method.</p><pre>putFile(r,'debian-logo.png','/home/pi/debian-logo.png.copy');</pre><p>Make sure that file is copied.</p><pre>system(r,'ls -l /home/pi/debian-logo.png.copy')</pre><p>You can delete files on your Raspberry Pi hardware using the deleteFile() command.</p><pre>deleteFile(r,'/home/pi/debian-logo.png.copy');</pre><p>Make sure that file is deleted.</p><pre>system(r,'ls -l /home/pi/debian-logo.png.copy')</pre><p>The preceding command should result in an error indicating that the file cannot be found.</p><h2 id="7">Summary</h2><p>This example introduced the workflow for running Linux shell commands on your Raspberry Pi Hardware. Using the Raspberry Pi support package, you turned the user LED on and off, executed system commands and manipulated files on the Raspberry Pi hardware.</p><p class="footer">Copyright 2012-2015 The MathWorks, Inc.<br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br><br>
		  MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.
      </p></div><!--
##### SOURCE BEGIN #####
%% Running Linux(R) Shell Commands
%
% This example shows you how to run Linux shell commands on your Raspberry
% Pi(R) hardware.
 
% Copyright 2012-2015 The MathWorks, Inc.


%% Introduction
%
% Raspberry Pi hardware runs a Linux(R) distribution as the operating
% system. Using utilities shipped in the Simulink Support Package for
% Raspberry Pi Hardware, you can remotely execute Linux shell commands on
% the Raspberry Pi hardware directly from the MATLAB(R) command line. For
% example, you can run and stop a Simulink(R) model, list the contents of a
% directory, look up the CPU load of a process running on the Raspberry Pi
% hardware, etc. You can also launch an interactive SSH session
% directly from within MATLAB.

%% Prerequisites
%
% * We recommend completing
% <docid:raspberrypi_ref.example-raspberrypi_gettingstarted Getting Started with Raspberry Pi(R) Hardware> example. 


%% Create a Communication Object
%
% Simulink Support Package for Raspberry Pi Hardware uses an SSH connection
% over TCP/IP to remotely execute Linux shell commands while building and
% running Simulink models on the Raspberry Pi hardware. You can use the
% infrastructure developed for this purpose to communicate with the
% Raspberry Pi hardware.
% 
% Create a raspberrypi object by executing the following on the MATLAB
% command line:
%
%  r = raspberrypi
%
% The *raspberrypi* function returns a connection object, h, for Raspberry
% Pi hardware that has been set up using the targetupdater function. The
% hostname, user name, and password used to construct the raspberrypi
% object are the default MATLAB session values for these parameters.
% Simulink Support Package for Raspberry Pi Hardware saves one set of
% communication parameters, i.e. hostname, user name and password, for the
% Raspberry Pi hardware as default MATLAB session values. Note, the default
% MATLAB session values for the communication parameters are first
% determined during the firmware update process. The communication
% parameters may subsequently be changed using the *Tools > Run on Target
% Hardware > Options...* UI in a Simulink model and are sticky, meaning
% that once you change the communication parameter values they are saved as
% default MATLAB session values, and are used for all Simulink models.
%
% You may explicitly specify the hostname or IP address, user name,
% password when you create the raspberrypi object:
%
%  r = raspberrypi('<hostname or IP address>','<user name>','<password>');
%
% The command above shows how to specify hostname, user name, and password.
% You may want to use this form if you have multiple Raspberry Pi hardware
% in your network that you want to connect at the same time.
%
% *NOTE:* In case of a connection failure, a diagnostics error message is
% reported on the MATLAB command line. If the connection has failed, the
% most likely cause is incorrect IP address or hostname.


%% Execute system commands on your Raspberry Pi
%
% You can use the system method of the raspberrypi object to execute
% various Linux shell commands on the Raspberry Pi hardware from MATLAB.
% Try taking a directory listing.
%
%  system(r,'ls -al ~')
%
% This statement executes a directory list shell command and returns the
% resulting text output at the MATLAB command prompt. You can store the
% result in a MATLAB variable to perform further processing. Establish who
% is the owner of the .profile file under /home/pi.
%
%  output = system(r,'ls -al /home/pi');
%  ret = regexp(output, '\s+[\w-]+\s+\d\s+(\w+)\s+.+\.profile\s+', 'tokens');
%  ret{1}
%  
% You can also achieve the same result using a single shell command.
%
%  system(r,'stat REPLACE_WITH_DASH_DASHformat="%U" /home/pi/.profile')
%  
% Blink the user LED using system commands.
%  
%  system(r,'echo "none" | sudo tee /sys/class/leds/led0/trigger');
%  system(r,'echo 0 | sudo tee /sys/class/leds/led0/brightness');
%  system(r,'echo 1 | sudo tee /sys/class/leds/led0/brightness');
%  
% The user LED is, by default, wired to trigger off of SD card activity.
% The LED is re-wired to not have a trigger, enabling setting the LED state
% manually. You can return the LED back to its original state.
%  
%  system(r,'echo "mmc0" | sudo tee /sys/class/leds/led0/trigger');
%  
% You cannot execute interactive system commands using the system() method. 
% To execute interactive commands on the Raspberry Pi hardware, you must
% open a terminal session. 
%  
%  openShell(r)
%  
% This command opens a PuTTY terminal that can execute interactive shell
% commands like 'top'.


%% Run/Stop a Simulink Model
% Simulink Support Package for Raspberry Pi Hardware generates a Linux
% executable for each Simulink model you run on the Raspberry Pi hardware.
% The generated executable has the same name as the Simulink model and is
% saved on the Raspberry Pi hardware. To run/stop a Simulink model, you can
% use the runModel and stopModel methods of the raspberrypi object.
%
% 1. To run a Simulink model you previously run on the Raspberry Pi
% hardware, execute the following command on the MATLAB command line:
%
%  runModel(r,'<model name>')
%
% where the string '<model name>' is the name of the Simulink model you
% want to run on the Raspberry Pi hardware. The runModel method launches
% the executable corresponding to the Simulink model you specified.
%
% 2. To stop a Simulink model running on the Raspberry Pi hardware, execute
% the following command on the MATLAB command line:
% 
%  stopModel(r,'<model name>')
%
% This command kills the Linux process with the name '<model name>.elf' on
% the Raspberry Pi hardware. Alternatively, you may execute the following
% command to stop the model:
%
%  system(r,'sudo killall <model name>.elf')


%% Manipulate files
% The raspberrypi object provides basic file manipulation capabilities. To
% transfer a file on Raspberry Pi hardware to your host computer you use
% the getFile() method.
%  
%  getFile(r,'/usr/share/pixmaps/debian-logo.png');
%  
% You can then read the PNG file in MATLAB:
%  
%  img = imread('debian-logo.png');
%  image(img);
%  
% The getFile() method takes an optional second argument that allows you to
% define the file destination. To transfer a file on your host computer to
% Raspberry Pi hardware, you use putFile() method.
%  
%  putFile(r,'debian-logo.png','/home/pi/debian-logo.png.copy');
%  
% Make sure that file is copied.
%  
%  system(r,'ls -l /home/pi/debian-logo.png.copy')
%  
% You can delete files on your Raspberry Pi hardware using the deleteFile()
% command. 
%  
%  deleteFile(r,'/home/pi/debian-logo.png.copy');
%  
% Make sure that file is deleted.
%  
%  system(r,'ls -l /home/pi/debian-logo.png.copy')
%  
% The preceding command should result in an error indicating that the file
% cannot be found.

%% Summary
% This example introduced the workflow for running Linux shell commands on
% your Raspberry Pi Hardware. Using the Raspberry Pi support package,
% you turned the user LED on and off, executed system commands and
% manipulated files on the Raspberry Pi hardware.


##### SOURCE END #####
--></body></html>