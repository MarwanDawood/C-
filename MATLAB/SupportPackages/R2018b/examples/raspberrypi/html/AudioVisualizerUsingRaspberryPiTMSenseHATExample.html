
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Audio Visualizer Using Raspberry Pi&#8482; Sense HAT</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-07-24"><meta name="DC.source" content="AudioVisualizerUsingRaspberryPiTMSenseHATExample.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><style>
.open_example { 
    padding:0px 0px 1px 0px;
    margin:20px;
    font-size:0.9em;
    border:1px solid #aeaeae;
    display:block;
    float:right;
    border-radius:5px; -moz-border-radius:5px; -webkit-border-radius:5px;
    background: #ffffff; /* Old browsers */
    background: -moz-linear-gradient(top, #FFFFFF 0%, #E6E6E6 100%); /* FF3.6+ */	
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(100%,#E6E6E6)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #FFFFFF 0%,#E6E6E6 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* IE10+ */
    background: linear-gradient(top,  #ffffff 0%,#e6e6e6 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#FFFFFF', endColorstr='#E6E6E6',GradientType=0 ); /* IE6-9 */
}

.open_example:hover {
    background: #f3f3f3; /* Old browsers */
    background: -moz-linear-gradient(top, #f3f3f3 0%, #d7d7d7 100%); /* FF3.6+ */    
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f3f3f3), color-stop(100%,#d7d7d7)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #f3f3f3 0%,#d7d7d7 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* IE10+ */
    background: linear-gradient(top,  #f3f3f3 0%,#d7d7d7 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f3f3f3', endColorstr='#d7d7d7',GradientType=0 ); /* IE6-9 */
} 

.open_example a { 
    padding:6px 10px; 
    line-height:130%;
    text-decoration:none;
    float:left;
}
      </style><div class="open_example"><a href="matlab:openExample('raspberrypi/AudioVisualizerUsingRaspberryPiTMSenseHATExample')">Open this Example</a></div><div class="content"><h1>Audio Visualizer Using Raspberry Pi&#8482; Sense HAT</h1><!--introduction--><p>This example shows how to simulate an audio visualizer on Sense HAT using the Simulink&reg; Support Package for Raspberry Pi&#8482; Hardware.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#3">Audio Visualizer</a></li><li><a href="#4">Prerequisites</a></li><li><a href="#5">Required Products</a></li><li><a href="#6">Required Hardware</a></li><li><a href="#7">Configure and Run the Audio Visualizer Model</a></li><li><a href="#10">Other Things to Try</a></li><li><a href="#11">Summary</a></li></ul></div><h2 id="1">Introduction</h2><p>Audio visualization is a technique of displaying an image or an animation that is synchronous to audio data being played. Using this technique, the Simulink&reg; model displays colored bars on the 8-by-8 LED matrix on Sense HAT. The movement of the bars is synchronized with the audio being played.</p><h2 id="3">Audio Visualizer</h2><p>In this example model, the Audio File Read block reads the specified audio file and outputs it as Pulse Code Modulation (PCM) data on the Raspberry Pi&#8482; hardware. The block is configured to read 8192 audio samples at each time step.</p><p>The Audio Processing subsystem computes a Fast Fourier Transform (FFT) across the samples of audio data. The subsystem converts the most significant 1024 samples from the computed FFT into logarithmic scale, reducing large dynamic variations in the frequency spectrum.</p><p>The MATLAB Function block, FFT2RGB, divides 1024 samples into 8 groups, and then calculates the length of each LED bar to be displayed on the Raspberry Pi&#8482; Sense HAT.</p><p>The ALSA Audio Playback block plays the input audio through the default audio jack of the Raspberry Pi&#8482; hardware. If the specified audio file is a mono file, convert it into stereo using the Vector Concatenate block. For example, in this model, the default audio file, <tt>guitartune.wav</tt>, is used. Because this file is mono, use the Vector Concatenate block to convert it to stereo.</p><h2 id="4">Prerequisites</h2><p>Before you start with this example, we recommend you complete the following examples:</p><div><ul><li><a href="docid:raspberrypi_ref.example-raspberrypi_audioequalizer">Parametric Audio Equalizer</a></li><li><a href="docid:raspberrypi_ref.example-raspberrypi_sensehat_autorotate">Auto-rotate an image displayed on Sense HAT LED matrix</a></li></ul></div><h2 id="5">Required Products</h2><p>To run this example, you must have a DSP System Toolbox&#8482; toolbox license.</p><h2 id="6">Required Hardware</h2><p>To run this example, you must have the following hardware:</p><div><ul><li>Raspberry Pi hardware</li><li>Sense HAT</li><li>Headphones or speakers</li></ul></div><h2 id="7">Configure and Run the Audio Visualizer Model</h2><p><b>1.</b> Connect a pair of speakers or headphones to the analog audio output of the Raspberry Pi&#8482; hardware.</p><p><b>2.</b> Plug the Sense HAT module into the GPIO pins of the Raspberry Pi&#8482; hardware.</p><p><b>3.</b> Open the <a href="matlab:raspberrypi_audioVisualizer.slx">Audio Visualizer</a> model.</p><p><img vspace="5" hspace="5" src="../raspberrypi_audioVisualizer_model.png" alt=""> </p><p><b>4.</b> On the Simulink&reg; model toolbar, select <b>Tools &gt; Run on Target Hardware &gt; Options...</b>.</p><p><b>5.</b> Browse to <b>Hardware Implementation &gt; Hardware board settings &gt; Target hardware resources</b>, and verify the connection settings.</p><p><b>6.</b> In the Simulink&reg; model, double-click the Audio File Read block. By default, the audio file specified is <tt>guitartune.wav</tt>. To play a different audio file, click <b>Browse</b>, and then select the required file from your computer. If the file that you select is a stereo file, remove the Vector Concatenate block from the model.</p><p><b>7.</b> Double-click the ALSA Audio Playback block. In this model, the block sends the audio signal to the <tt>'hw:0,0'</tt> audio device on the Raspberry Pi hardware. <tt>'hw:0,0'</tt> is the default audio jack. To list the audio playback devices available on your Raspberry Pi&#8482; hardware, enter the following commands in the MATLAB&reg; command window.</p><pre>r = raspberrypi;
a = listAudioDevices(r,'playback')</pre><p>The resulting structured array contains the names and numbers of the available audio playback devices on your Raspberry Pi&#8482; hardware.</p><p>A sample output is shown here:</p><pre>a(1)
    Name: ' bcm2835 - bcm2835 ALSA...'
  Device: '0,0'</pre><pre>a(2)
    Name: ' bcm2835 - bcm2835 ALSA...'
  Device: '0,1'</pre><pre>a(3)
    Name: ' USB-Audio - USB PnP Sound Device...'
  Device: '1,0'</pre><p>This result indicates that three audio playback devices are available on the Raspberry Pi&#8482; hardware. The ALSA audio device numbers are '|0,0|', '|0,1|', and '|1,0|'. The first two devices correspond to the analog audio output and the HDMI output of the Raspberry Pi&#8482; hardware. The third device is a USB audio dongle. To use the playback device <tt>0,0</tt>, double-click the ALSA Audio Playback block, and specify the <b>Device name</b> parameter as <tt>'plughw:0,0'</tt>.</p><p><b>8.</b> On the Simulink&reg; model toolbar, click the Deploy To Hardware button. This action builds, downloads, and runs the model on the Raspberry Pi hardware. The audio starts playing, and the colored bars on the 8x8 LED matrix of Sense HAT are displayed in synchronization with the audio being played.</p><h2 id="10">Other Things to Try</h2><div><ul><li>Change the audio source file in Audio File Read block to your favorite music file.</li><li>Replace the Audio File Read block with ALSA Audio Capture block from the Raspberry Pi block library to experience real-time speech visualization.</li></ul></div><h2 id="11">Summary</h2><p>This example demonstrated how to configure the Simulink&reg; model to simulate an audio visualizer on Sense HAT.</p><p class="footer">Copyright 2017 The MathWorks, Inc.<br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br><br>
		  MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.
      </p></div><!--
##### SOURCE BEGIN #####
%% Audio Visualizer Using Raspberry Pi(TM) Sense HAT
%
% This example shows how to simulate an audio visualizer on Sense HAT using the Simulink(R)
% Support Package for Raspberry Pi(TM) Hardware.

% Copyright 2017 The MathWorks, Inc.

%% Introduction
%
% Audio visualization is a technique of displaying an image or an animation
% that is synchronous to audio data being played. Using this technique, the
% Simulink(R) model displays colored bars on the 8-by-8 LED matrix on Sense
% HAT. The movement of the bars is synchronized with the audio being played. 
%
%%
%% Audio Visualizer
%
% In this example model, the Audio File Read block reads the specified
% audio file and outputs it as Pulse Code Modulation
% (PCM) data on the Raspberry Pi(TM) hardware. The block
% is configured to read 8192 audio samples at each time step.
%
% The Audio Processing subsystem computes a Fast Fourier Transform (FFT)
% across the samples of audio data. The subsystem converts the most
% significant 1024 samples from the computed FFT into logarithmic
% scale, reducing large dynamic variations in the frequency spectrum.
%
% The MATLAB Function block, FFT2RGB, divides 1024 samples
% into 8 groups, and then calculates
% the length of each LED bar to be displayed on the Raspberry Pi(TM)
% Sense HAT.
%
% The ALSA Audio Playback block plays the input audio through the
% default audio jack of the Raspberry Pi(TM) hardware. If the specified
% audio file is a mono file, convert it into stereo using the Vector
% Concatenate block. For example, in this model, the default audio file,
% |guitartune.wav|, is used. Because this file is mono, use the Vector
% Concatenate block to convert it to stereo.
%
%% Prerequisites
%
% Before you start with this example, we recommend you complete the following examples: 
%
% * <docid:raspberrypi_ref.example-raspberrypi_audioequalizer Parametric Audio Equalizer> 
% * <docid:raspberrypi_ref.example-raspberrypi_sensehat_autorotate  Auto-rotate an image displayed on Sense HAT LED matrix>

%% Required Products
%
% To run this example, you must have a DSP System Toolbox(TM) toolbox
% license.
%
%% Required Hardware
%
% To run this example, you must have the following hardware:
%
% * Raspberry Pi hardware
% * Sense HAT
% * Headphones or speakers
%
%% Configure and Run the Audio Visualizer Model
%
% *1.* Connect a pair of speakers or headphones to the analog audio output
% of the Raspberry Pi(TM) hardware.
%
% *2.* Plug the Sense HAT module into the GPIO pins of the Raspberry Pi(TM)
% hardware.
%
% *3.* Open the <matlab:raspberrypi_audioVisualizer.slx Audio Visualizer>
% model.
%
%%
% 
% <<../raspberrypi_audioVisualizer_model.png>>
% 
%%
%
% *4.* On the Simulink(R) model toolbar, select *Tools > Run on Target Hardware > Options...*. 
%
% *5.* Browse to *Hardware Implementation > Hardware board settings >
% Target hardware resources*, and verify the connection settings.
% 
% *6.* In the Simulink(R) model, double-click the Audio File Read block.
% By default, the audio file specified is |guitartune.wav|. To play a
% different audio file, click *Browse*, and then select the required file from your
% computer. If the file that you select is a stereo file, remove the Vector
% Concatenate block from the model.
%
% *7.* Double-click the ALSA Audio Playback block. In this model, the block
% sends the audio signal to the |'hw:0,0'| audio device on the
% Raspberry Pi hardware. |'hw:0,0'| is the default audio jack. To list the
% audio playback devices available on your Raspberry Pi(TM) hardware, enter
% the following commands in the MATLAB(R) command window.
%
%  r = raspberrypi; 
%  a = listAudioDevices(r,'playback')
% 
% The resulting structured array contains the names and numbers of the
% available audio playback devices on your Raspberry Pi(TM) hardware.
%
% A sample output is shown here:
%
%  a(1)
%      Name: ' bcm2835 - bcm2835 ALSA...'
%    Device: '0,0'
%
%  a(2)
%      Name: ' bcm2835 - bcm2835 ALSA...'
%    Device: '0,1'
%
%  a(3)
%      Name: ' USB-Audio - USB PnP Sound Device...'
%    Device: '1,0'
%
% This result indicates that three audio playback devices
% are available on the Raspberry Pi(TM) hardware. The ALSA audio device numbers
% are '|0,0|', '|0,1|', and '|1,0|'. The first two
% devices correspond to the analog audio output and the HDMI output of the
% Raspberry Pi(TM) hardware. The third device is a USB audio dongle. To use
% the playback device |0,0|, double-click the ALSA Audio Playback block,
% and specify the *Device name* parameter as |'plughw:0,0'|.
%
% *8.* On the Simulink(R) model toolbar, click the Deploy To Hardware
% button. This action builds, downloads, and runs the model on the
% Raspberry Pi hardware. The audio starts playing, and the colored
% bars on the 8x8 LED matrix of Sense HAT are displayed in synchronization
% with the audio being played.
%
%% Other Things to Try
%
% * Change the audio source file in Audio File Read block to your favorite
% music file.
% * Replace the Audio File Read block with ALSA Audio Capture block
% from the Raspberry Pi block library to experience real-time speech
% visualization.
%
%% Summary
%
% This example demonstrated how to configure the Simulink(R) model to simulate
% an audio visualizer on Sense HAT.
% 

##### SOURCE END #####
--></body></html>